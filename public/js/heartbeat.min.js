$(document).ready(function(){function e(){const e="{{ route('login') }}";fetch("{{ route('profile.heartbeat') }}",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":a},body:JSON.stringify({isFocused:t})}).then(t=>{t.ok?t.redirected&&t.url===e?(console.log("User is not authenticated, redirecting to login..."),window.location.href=e):t.json().then(e=>{$class="avatar avatar-"+e.data.last_seen+" position-relative",$("#user-avatar").removeClass().addClass($class),$("#user-avatar-drop").removeClass().addClass($class)}):(console.error("Heartbeat failed:",t.statusText),401===t.status&&(window.location.href=e))}).catch(e=>{console.error("Heartbeat failed:",e)})}let t=!0;const a=document.querySelector('meta[name="csrf-token"]').getAttribute("content");window.addEventListener("visibilitychange",function(){"visible"===document.visibilityState?(t=!0,e()):t=!1}),e(),setInterval(e,12e4)});